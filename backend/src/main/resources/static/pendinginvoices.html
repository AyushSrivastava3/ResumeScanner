<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pending Invoices</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f7f7f7;
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            background-color: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        th, td {
            padding: 15px;
            text-align: left;
            border: 1px solid #ddd;
        }
        th {
            background-color: #f4f4f4;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
    </style>
</head>
<body>
<div id="header"></div>
<h1>Pending Invoices</h1>
<table>
    <thead>
    <tr>
        <th>Client Name</th>
        <th>Invoice Number</th>
        <th>Invoice Value</th>
        <th>Currency</th>
        <th>Month</th>
        <th>Raised On</th>
        <th>Timeline</th>
    </tr>
    </thead>
    <tbody id="invoiceTableBody">
    <!-- Invoices will be populated here by JavaScript -->
    </tbody>
</table>

<div id="footer"></div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
    // Load header and footer
        fetch('header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('header').innerHTML = data;
            });

        fetch('footer.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('footer').innerHTML = data;
            });


           const token = localStorage.getItem('accessToken');

       if (!token) {
           showModal("You have not yet logged in. Kindly login first.");
           return;
       }

       function showModal(message) {
           const modal = document.createElement('div');
           modal.style.position = 'fixed';
           modal.style.top = '50%';
           modal.style.left = '50%';
           modal.style.transform = 'translate(-50%, -50%)';
           modal.style.padding = '20px';
           modal.style.backgroundColor = '#fff';
           modal.style.boxShadow = '0 0 10px rgba(0, 0, 0, 0.1)';
           modal.innerHTML = `
               <p>${message}</p>
               <button id="closeModal">Close</button>
           `;
           document.body.appendChild(modal);

           document.getElementById('closeModal').addEventListener('click', function() {
               modal.remove();
               window.location.href = 'login.html'; // Redirect to login page
           });

           document.getElementById('closeModal').style.backgroundColor = '#005149';
           document.getElementById('closeModal').style.color = '#fff';
           document.getElementById('closeModal').style.border = 'none';
           document.getElementById('closeModal').style.padding = '10px';
           document.getElementById('closeModal').style.borderRadius = '5px';
           document.getElementById('closeModal').style.cursor = 'pointer';
       }

       fetch('http://43.205.154.85:8080/api/invoices/pending')
           .then(response => response.json())
           .then(invoices => {
               const tableBody = document.getElementById('invoiceTableBody');
               invoices.forEach(invoice => {
                   const row = document.createElement('tr');
                   row.innerHTML = `
                       <td>${invoice.clientName}</td>
                       <td>${invoice.invoiceNumber}</td>
                       <td>${invoice.invoiceValue}</td>
                       <td>${invoice.currency}</td>
                       <td>${invoice.month}</td>
                       <td>${invoice.raisedOn}</td>
                       <td>${invoice.timeline}</td>
                   `;
                   tableBody.appendChild(row);
               });
           })
           .catch(error => {
               console.error('Error fetching pending invoices:', error);
           });
   });


</script>

</body>
</html>
