<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All Invoices</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 8px 12px;
            border: 1px solid #ddd;
            text-align: left;
        }
        th {
            background-color: #f4f4f4;
        }
        .container {
            width: 80%;
            margin: 20px auto;
        }
    </style>
</head>
<body>
<div id="header"></div>

<div class="container">
    <h2>All Invoices</h2>
    <table id="invoicesTable">
        <thead>
        <tr>
            <th>Invoice Number</th>
            <th>Client Name</th>
            <th>Invoice Value</th>
            <th>Currency</th>
        </tr>
        </thead>
        <tbody>
        <!-- Rows will be added dynamically here -->
        </tbody>
    </table>
</div>
<!-- Include Footer -->
<div id="footer"></div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
    // Load header and footer
        fetch('header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('header').innerHTML = data;
            });

        fetch('footer.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('footer').innerHTML = data;
            });

            const token = localStorage.getItem('accessToken');

        if (!token) {
            showModal("You have not yet logged in. Kindly login first.");
            return;
        }

        function showModal(message) {
            const modal = document.createElement('div');
            modal.style.position = 'fixed';
            modal.style.top = '50%';
            modal.style.left = '50%';
            modal.style.transform = 'translate(-50%, -50%)';
            modal.style.padding = '20px';
            modal.style.backgroundColor = '#fff';
            modal.style.boxShadow = '0 0 10px rgba(0, 0, 0, 0.1)';
            modal.innerHTML = `
                <p>${message}</p>
                <button id="closeModal">Close</button>
            `;
            document.body.appendChild(modal);

            document.getElementById('closeModal').addEventListener('click', function() {
                modal.remove();
                window.location.href = 'login.html'; // Redirect to login page
            });

            document.getElementById('closeModal').style.backgroundColor = '#005149';
            document.getElementById('closeModal').style.color = '#fff';
            document.getElementById('closeModal').style.border = 'none';
            document.getElementById('closeModal').style.padding = '10px';
            document.getElementById('closeModal').style.borderRadius = '5px';
            document.getElementById('closeModal').style.cursor = 'pointer';
        }

        fetch('http://localhost:8080/api/invoices/all')
            .then(response => response.json())
            .then(invoices => {
                const invoicesTable = document.getElementById('invoicesTable').getElementsByTagName('tbody')[0];
                invoices.forEach(invoice => {
                    const row = invoicesTable.insertRow();
                    const invoiceNumberCell = row.insertCell(0);
                    const invoiceLink = document.createElement('a');
                    invoiceLink.href = `editInvoice.html?id=${invoice.id}`;
                    invoiceLink.textContent = invoice.invoiceNumber;
                    invoiceNumberCell.appendChild(invoiceLink);
                    row.insertCell(1).textContent = invoice.clientName; // Assuming invoice contains clientName
                    row.insertCell(2).textContent = invoice.invoiceValue;
                    row.insertCell(3).textContent = invoice.currency;
                });
            })
            .catch(error => console.error('Error fetching invoices:', error));
    });

</script>
</body>
</html>
